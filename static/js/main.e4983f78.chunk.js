(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{24:function(e,t,n){e.exports=n(35)},29:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(21),s=n.n(r),c=n(3),l=n(4),i=n(6),h=n(5),u=n(7),p=n(10),f=n(17),m="https://reactnd-books-api.udacity.com",b=localStorage.token;b||(b=localStorage.token=Math.random().toString(36).substr(-8));var k={Accept:"application/json",Authorization:b},d=function(){return fetch("".concat(m,"/books"),{headers:k}).then(function(e){return e.json()}).then(function(e){return e.books})},v=function(e,t){return fetch("".concat(m,"/books/").concat(e.id),{method:"PUT",headers:Object(f.a)({},k,{"Content-Type":"application/json"}),body:JSON.stringify({shelf:t})}).then(function(e){return e.json()})},g=function(e){return fetch("".concat(m,"/search"),{method:"POST",headers:Object(f.a)({},k,{"Content-Type":"application/json"}),body:JSON.stringify({query:e})}).then(function(e){return e.json()}).then(function(e){return e.books})},E=(n(29),function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(i.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).state={selectShelf:n.props.book.shelf||"none"},n.onChangeShelf=function(e,t){n.setState({selectShelf:t}),n.props.onChangeShelf(e,t)},n.componentWillReceiveProps=function(e){n.props=e,n.setState({selectShelf:n.props.book.shelf})},n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"book-shelf-changer"},o.a.createElement("select",{value:this.state.selectShelf,onChange:function(t){return e.onChangeShelf(e.props.book,t.target.value)}},o.a.createElement("option",{value:"",disabled:!0},"Move to..."),o.a.createElement("option",{value:"currentlyReading"},"Currently Reading"),o.a.createElement("option",{value:"wantToRead"},"Want to Read"),o.a.createElement("option",{value:"read"},"Read"),o.a.createElement("option",{value:"none"},"None")))}}]),t}(a.Component)),y=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(i.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).state={selectShelf:n.props.book.shelf||"none"},n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=this.props.book.authors&&this.props.book.authors.join(" & "),n=this.props.book.imageLinks&&"url(".concat(this.props.book.imageLinks.thumbnail,")");return o.a.createElement("div",{className:"book"},o.a.createElement("div",{className:"book-top"},o.a.createElement("button",{className:"book-cover-button",onClick:function(t){return e.props.book}},o.a.createElement("div",{className:"book-cover",style:{width:128,height:193,backgroundImage:n}})),o.a.createElement(E,{book:this.props.book,onChangeShelf:this.props.onChangeShelf})),o.a.createElement("div",{className:"book-title"},this.props.book.title),o.a.createElement("div",{className:"book-authors"},t))}}]),t}(a.Component),S=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(i.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).state={},n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"bookshelf"},o.a.createElement("h2",{className:"bookshelf-title"},this.props.shelf.name),o.a.createElement("div",{className:"bookshelf-books"},o.a.createElement("ol",{className:"books-grid"},this.props.shelf.books.map(function(t){return o.a.createElement("li",{key:t.id},o.a.createElement(y,{book:t,onChangeShelf:e.props.onChangeShelf}))}))))}}]),t}(a.Component),j=n(11),O=function(e){return o.a.createElement("div",{className:"open-search"},o.a.createElement(j.b,{to:"./Search"},"Search"))},C=function(e){return o.a.createElement("div",{className:"list-books-title"},o.a.createElement("h1",null,e.title))},N=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(i.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).state={},n.componentDidMount=function(){n.props.onRefreshBooks()},n.shelfUpdater=function(){return[{name:"Currently Reading",books:n.props.books.filter(function(e){return"currentlyReading"===e.shelf})},{name:"Want to Read",books:n.props.books.filter(function(e){return"wantToRead"===e.shelf})},{name:"Read",books:n.props.books.filter(function(e){return"read"===e.shelf})}]},n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this,t=[];return this.props.books&&this.props.books.length&&(t=this.shelfUpdater()),o.a.createElement("div",{className:"app"},o.a.createElement(C,{title:"My Books"}),o.a.createElement("div",{className:"list-books-content"},o.a.createElement("div",null,t&&t.map(function(t){return o.a.createElement(S,{key:t.name,shelf:t,onChangeShelf:e.props.onChangeShelf})}))),o.a.createElement(O,null))}}]),t}(a.Component),w=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(i.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).state={books:[],query:""},n.mergePages=function(e,t){var n={};return e.forEach(function(e){return n[e.id]=e.shelf}),t.forEach(function(e){e.shelf=n[e.id]||"none"}),t},n.queryTimer=null,n.changeQuery=function(e){clearTimeout(n.queryTimer),n.setState({query:e}),n.queryTimer=setTimeout(n.updateSearch,200)},n.updateSearch=function(){""!==n.state.query?g(n.state.query).then(function(e){var t=[],a=!1;void 0===e||e.error&&"empty query"!==e.error?a=!0:e.length&&(t=n.mergePages(n.props.selectedBooks,e)),n.setState({error:a,books:t})}):n.setState({error:!1,books:[]})},n.componentWillReceiveProps=function(e){n.props=e;var t=(n.props.selectedBooks,n.state.books);n.setState({books:t})},n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"search-books"},o.a.createElement("div",{className:"search-books-bar"},o.a.createElement(j.b,{className:"close-search",to:"/"},"Close"),o.a.createElement("div",{className:"search-books-input-wrapper"},o.a.createElement("input",{type:"text",placeholder:"Enter Search Here",onChange:function(t){return e.changeQuery(t.target.value)},value:this.state.query.value}))),o.a.createElement("div",{className:"search-books-results"},this.state.error&&o.a.createElement("div",{className:"search-error"},"Oh no! Something went wrong"),!this.state.error&&o.a.createElement("span",{className:"search-count"},"There are \xa0",this.state.books.length,"\xa0 books that match your search"),o.a.createElement("ol",{className:"books-grid"},this.state.books&&this.state.books.map(function(t){return o.a.createElement("li",{key:t.id},o.a.createElement(y,{book:t,onChangeShelf:e.props.onChangeShelf}))}))))}}]),t}(a.Component),R=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];return(n=Object(i.a)(this,(e=Object(h.a)(t)).call.apply(e,[this].concat(o)))).state={},n.componentDidMount=function(){n.state.newBook&&n.refreshBooks()},n.refreshBooks=function(){d().then(function(e){n.setState({books:e,newBook:!1})})},n.changeShelf=function(e,t){v(e,t).then(function(a){var o=n.state.books.slice(0),r=o.filter(function(t){return t.id===e.id});r.length?r[0].shelf=t:o.push(e),n.setState({books:o})})},n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this;return o.a.createElement("div",{className:"app"},o.a.createElement(p.c,null,o.a.createElement(p.a,{exact:!0,path:"/",render:function(){return o.a.createElement(N,{books:e.state.books,onChangeShelf:e.changeShelf,onRefreshBooks:e.refreshBooks})}}),o.a.createElement(p.a,{exact:!0,path:"/Search",render:function(){return o.a.createElement(w,{selectedBooks:e.state.books,onChangeShelf:e.changeShelf})}})))}}]),t}(o.a.Component);n(34);s.a.render(o.a.createElement(j.a,null,o.a.createElement(R,null)),document.getElementById("root"))}},[[24,1,2]]]);
//# sourceMappingURL=main.e4983f78.chunk.js.map